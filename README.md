# Web Server with custom video and audio player #

## For what this is ##
This web server facilitates file sharing via a web browser, allowing users to stream videos, music, and other file types.    
It supports file uploads, creation, and deletion, all managed under a single "write" permission group. Access control is
handled through ACLs (Access Control Lists), enabling administrators to set permissions for each resource.
Users can be granted or denied read-only access, write permissions (upload, create, delete), or complete access restriction to specific resources.    

## Multimedia (video) ##
 - All video/audio codecs supported by the browser (this server does not use transcoding)
 - All tracks (audio, video, subtitles and metadata) must be in the same container.
 - Ability to change audio track (enable experimental web platform features)
 - SSA/ASS subtitles support by using JASSUB on the client    
 - Convert SSA in a safe way to webVTT, to do it hold the settings button
 - Recommended to use mkv/mp4 container for videos and AV1 as the video codec.
    - Note that both firefox and safari dont support mkv files.
    - If ASS/SSA subtitles are needed use mkv and a chromium-based browser.

## ACL permissions and Users ##
  Both ACLs and users are managed through a script called aclmgr.py, located in the app directory.    
  See the [documentation](aclmgr.md) for how to use it.

## Requirements: ##
 Install all requirements with
 ```pip install -r requirements.txt```    
 For the video player to work: ```ffmpeg``` (as system package)

## Config ##
The following environment variables are used to configure the server:

  - SERVE_PATH (required): Specifies the directory that will be served.
  - ERRLOG_FILE: Defines the file where server error logs will be stored.
  - ACL_FILE: Specifies the file that contains the Access Control List (ACL) rules.
  - USERS_FILE: Specifies the file where user account data is stored.
  - SESSIONS_DB: Defines the file used for storing session-related data.
  - SECRET_KEY (optional, default: autogenerated): Defines the secret key, useful in scenarios with multiworkers.
  - SHOW_DIRSIZE (optional, default: False): If set to True, the server will display the total size of directories.

## To run the web server: ##  
   **If using a reverse proxy ensure that POST buffering is disabled, in NGINX is proxy_request_buffering off;**     
   
  - To run via flask internal HTTP server via CLI (will run in localhost and port 8000)    
    ```python3 app.py```

  - To use a WSGI for deployment -> (for example gunicorn)    
    ```gunicorn -b IP_addr app:app```
